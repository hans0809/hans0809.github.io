<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>南极Python - Python|机器学习|深度学习</title><meta name="description" content="昨夜星辰昨夜风"><meta name="keywords" content="Python|机器学习|深度学习|生活感悟"><meta name="author" content="雨落诗山山亦奇"><meta name="copyright" content="雨落诗山山亦奇"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="http://yoursite.com/page/9/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="website"><meta property="og:title" content="南极Python"><meta property="og:url" content="http://yoursite.com/page/9/"><meta property="og:site_name" content="南极Python"><meta property="og:description" content="昨夜星辰昨夜风"><meta property="og:image" content="http://yoursite.com/img/avatar.png"><meta property="article:published_time" content="2021-10-10T09:14:46.863Z"><meta property="article:modified_time" content="2021-10-10T09:14:46.863Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"我爱学习,机器学习,深度学习,学习使我快乐","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2021-10-10 17:14:46'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="/css/mouse.css">
<link rel="stylesheet" href="/css/gundongtiao.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macblack.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"> <link rel="stylesheet" href="/css/waigua.css"> <link rel="stylesheet" href="/css/beijing.css"><div class="aplayer" data-id="476185587" data-server="netease" data-type="playlist" data-fixed="true" data-listFolded="false" data-order="list" data-preload="auto"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lete114/CDN/music/APlayer/APlayer.min.css"><script src="https://cdn.jsdelivr.net/gh/lete114/CDN/music/APlayer/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script><meta name="generator" content="Hexo 4.2.1"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">117</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">12</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">13</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><header class="full_page" id="page-header" style="background-image: url(/img/tag1.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">南极Python</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">南极Python</h1><div id="site_subtitle"><span id="subtitle"></span></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/11/CGAN/" title="CGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/11/0cPDHg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/11/CGAN/" title="CGAN">CGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-11 09:03:36"><i class="far fa-calendar-alt"></i>2020-10-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">什么是CGAN所谓CGAN，就是在GAN的基础上，多施加了一些条件信息，比如图像的标签等，使得生成器可以按照我们指定的标签去生成所对应的图像。
普通GAN的目标函数为：

而CGAN的目标函数为：

CGAN的网络结构如下：

如何构建CGAN本文在普通GAN（全连接层搭建）的基础上，将生成器的输入由“噪声”改为“噪声+对应该批次图像的真实标签”，将判别器的输入由”图像”改为”图像+对应该批次图像的真实标签”，最后在测试生成器的生成能力时，人为构建了0到9这10个数字作为标签（因为训练数据是mnist数据集），和随机噪声一起喂入生成器以产生新的图片。
Tensorflow2.0 实现CGAN导入所需函数12345678910import tensorflow as tffrom tensorflow import kerasfrom tensorflow.keras import layersfrom tensorflow.keras.layers import Input,multiply,Flatten,Embeddingfrom tensorflow.keras.models i ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/10/tf-keras-layers-Embedding/" title="tf.keras.layers.Embedding">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/07/10/UKkian.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="tf.keras.layers.Embedding"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/10/tf-keras-layers-Embedding/" title="tf.keras.layers.Embedding">tf.keras.layers.Embedding</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-10 22:27:37"><i class="far fa-calendar-alt"></i>2020-10-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Tensorflow%E7%AC%94%E8%AE%B0/">Tensorflow笔记</a></span></div><div class="content">函数原型1tf.keras.layers.Embedding(input_dim, output_dim, embeddings_initializer='uniform',    embeddings_regularizer=None, activity_regularizer=None,    embeddings_constraint=None, mask_zero=False, input_length=None, **kwargs)

举个图像数据的例子这里的input_shape是(10)，output_shape是np.prod((28, 28, 1))
1234567from tensorflow.keras.layers import multiply,Flatten,Embeddingimg=tf.ones((2,28,28,1))#两张图片label=np.array([1,2])#两个标签label_embedding = Flatten()(Embedding(10, np.prod((28, 28, 1)))(label))flat_img = Flatte ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/10/FrechetInceptionDistance/" title="FrechetInceptionDistance">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/10/0yk7E4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FrechetInceptionDistance"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/10/FrechetInceptionDistance/" title="FrechetInceptionDistance">FrechetInceptionDistance</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-10 13:30:39"><i class="far fa-calendar-alt"></i>2020-10-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">什么是FIDFréchet Inception Distance (FID) 度量了真实图片和生成图片在 feature 层面的距离
FID越小，则图像多样性越好，质量也越好 
众所周知，预训练好的神经网络顶层可以提取图片的高级信息，一定程度能反映图片的本质。因此，FID 的提出者通过预训练的 Inception V3 来提取全连接层之前的 2048 维向量，作为图片的特征。 具体的做法是：去掉最后的输出层（ 最后一层是一个pooling层，原来的网络通过该pooling层可以输出一张图像的类别 ），然后得到一个2048维的高层特征，这个高层特征是一个长向量形式。
FID的计算公式如下：
   
 
在这里，将每一张图片输入分类器中，都会得到一个2048维的长向量，对所有图片得到的长向量求平均值，求协方差矩阵，就得到了公式中的四个部分的值。
FID 只把 Inception V3 作为特征提取器，并不依赖它判断图片的具体类别，因此不必担心 Inception V3 的训练数据和生成模型的训练数据不同。同时，由于直接衡量生成数据和真实数据的分布之间的距离，也不必担心每个类别内部只产生一模 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/09/InceptionScore/" title="InceptionScore">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/09/0DzSun.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="InceptionScore"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/09/InceptionScore/" title="InceptionScore">InceptionScore</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-09 12:51:32"><i class="far fa-calendar-alt"></i>2020-10-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">  IS使用两个标准来衡量GAN的性能： 

The quality of the generated images, and
their diversity.

熵可以看作是对随机性的度量。如果随机变量x的值是高度可预测的，则其熵较低。相反，如果它是高度不可预测的，那么熵就很高。例如，在下图中，我们有两个概率分布p（x）。p2具有比p1更高的熵，因为p2具有更均匀的分布，所以更难以预测x。 
  
质量在GAN中，我们希望条件概率P（y | x）具有高度可预测性（低熵），比如红色线表示的分布。
（Images that are classified strongly as one class over all other classes indicate a high quality. As such, the conditional probability of all generated images in the collection should have a low entropy. ）
即给定一张图像，我们应该容易地知道对象的类型。因此，我们使用Inception网络对生 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/08/WGAN/" title="WGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/08/00iuyd.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/08/WGAN/" title="WGAN">WGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-08 15:38:51"><i class="far fa-calendar-alt"></i>2020-10-08</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">网络结构在基础GAN或DCGAN（本文）的基础上，使用推土机距离衡量真实样本分布与生成样本分布之间的距离，此时，即使两个分布没有重合部分（这经常发生，容易导致梯度突变），也能准确的衡量分布的差异。
 
从上图可以看出，WGAN的梯度永远不会为0，而普通GAN会出现梯度为0的情况。
根据
 
可以确定判别器和生成器的损失为：
 
其中，1-Lipscgitz是指$||f(x_1)-f(x_2)||\le1*||x_1-x_2||$
也就是导数要≤1
这一点，可以通过对权值进行clip的方式，使得权值固定在某个区间内，从而也使得导数固定在某一区间内(比如≤1)
下面的代码在DCGAN的基础上，修改了判别器和生成器的损失函数，并在每次权值更新后做了权值裁剪，其余未变。
导入相关函数12345import tensorflow as tffrom tensorflow import kerasfrom tensorflow.keras import layersimport matplotlib.pyplot as pltimport numpy as np

准备数据1(train_imag ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/07/LSGAN/" title="LSGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/07/0dQ7qS.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LSGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/07/LSGAN/" title="LSGAN">LSGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-07 18:23:33"><i class="far fa-calendar-alt"></i>2020-10-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">网络结构在DCGAN(本文)或者普通GAN的基础上，将交叉熵损失改为均方误差损失，就得到了LSGAN
LSGAN是对之前两种GAN的优化，因为当生成器生成的数据分布$P_G$与数据的真实分布$P_{data}$不重叠时，JS散度永远都是log2，从而导致生成器难以更新，见下图
 
 
导入相关函数12345import tensorflow as tffrom tensorflow import kerasfrom tensorflow.keras import layersimport matplotlib.pyplot as pltimport numpy as np

准备数据1(train_images,_),(_,_)=tf.keras.datasets.mnist.load_data()


1train_images.shape




(60000, 28, 28)1train_images.dtype




dtype(&apos;uint8&apos;)1train_images=train_images.reshape(train_images.shape[0] ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/07/DCGAN/" title="DCGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/07/0dSxjx.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DCGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/07/DCGAN/" title="DCGAN">DCGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-07 16:24:10"><i class="far fa-calendar-alt"></i>2020-10-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">网络结构同普通GAN ，只是将生成器与判别器网络中的Dense层换为了卷积层与转置卷积层，故整体代码只需改动生成器和判别器的网络搭建函数即可。
导入相关函数12345import tensorflow as tffrom tensorflow import kerasfrom tensorflow.keras import layersimport matplotlib.pyplot as pltimport numpy as np

准备数据1(train_images,_),(_,_)=tf.keras.datasets.mnist.load_data()


1train_images.shape




(60000, 28, 28)1train_images.dtype




dtype(&apos;uint8&apos;)1train_images=train_images.reshape(train_images.shape[0],28,28,1).astype('float32')


1train_images.shape




(60000, 28, 28, 1 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/06/%E5%9F%BA%E7%A1%80GAN/" title="基础GAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/06/0U2zKf.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基础GAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/06/%E5%9F%BA%E7%A1%80GAN/" title="基础GAN">基础GAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-06 22:23:20"><i class="far fa-calendar-alt"></i>2020-10-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">网络结构 
导入相关函数12345import tensorflow as tffrom tensorflow import kerasfrom tensorflow.keras import layersimport matplotlib.pyplot as pltimport numpy as np

准备数据1(train_images,_),(_,_)=tf.keras.datasets.mnist.load_data()


1train_images.shape




(60000, 28, 28)1train_images.dtype




dtype(&apos;uint8&apos;)1train_images=train_images.reshape(train_images.shape[0],28,28,1).astype('float32')


1train_images.shape




(60000, 28, 28, 1)1train_images.dtype




dtype(&apos;float32&apos;)1train_images=( ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/06/%E4%BA%A4%E5%8F%89%E7%86%B5%E3%80%81%E7%9B%B8%E5%AF%B9%E7%86%B5/" title="【常用于分类问题】交叉熵、相对熵">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/06/0UuvPP.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【常用于分类问题】交叉熵、相对熵"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/06/%E4%BA%A4%E5%8F%89%E7%86%B5%E3%80%81%E7%9B%B8%E5%AF%B9%E7%86%B5/" title="【常用于分类问题】交叉熵、相对熵">【常用于分类问题】交叉熵、相对熵</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-06 16:34:34"><i class="far fa-calendar-alt"></i>2020-10-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">深度学习笔记</a></span></div><div class="content">假设有离散型随机变量X的两个概率分布$p(x)$和$q(x)$，其中$p(x)$是数据的真实分布，$q(x)$是预测的数据分布。使用交叉熵或相对熵来度量$q(x)$逼近$p(x)$的效果，逼近程度越高，则两者的交叉熵或者相对熵就越小，因此可作为损失函数。
交叉熵$$H(p,q)=\sum_ip(x_i)log\frac1{q(x_i)}=-\sum_ip(x_i)log(q(x_i))$$
二分类对于二分类问题，真实标签一般用0和1来表示，假设真实的标签为$y_1,y_2,…,y_k$，预测得到的列向量为$yp_1,yp_2,…yp_k$
其中$y_i\in{0,1},i=1,2,…,k$
则交叉熵损失为$$H(y,yp)=-(y_1log(yp_1)+y_2log(yp_2)+…+y_klog(yp_k))$$
举个例子，假设共4个样本，其真实标签分别是$$ \begin{bmatrix}   1  &amp;0&amp;1&amp;0  \end{bmatrix}$$（经sigmoid激活函数）预测输出得到$$ \begin{bmatrix}0.3&amp;0.2&amp;0.4& ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/03/%E5%B9%BB%E5%90%AC/" title="幻听">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/03/010qXT.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="幻听"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/03/%E5%B9%BB%E5%90%AC/" title="幻听">幻听</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-03 09:11:49"><i class="far fa-calendar-alt"></i>2020-10-03</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E5%91%93%E8%AF%AD%E7%B3%BB%E5%88%97%E8%BF%9E%E8%BD%BD/">呓语系列连载</a></span></div><div class="content">转瞬即逝的美丽最适合在一遍又一遍的怀念里打磨出永恒的光彩

在远方的时候
又想你到泪流
这矫情的措辞结构
经历过的人会懂
那些不堪言的疼痛
也就是我自作自受
你没有装聋
你真没感动
一个人的时候
偷偷看你的微博
你转播的歌好耳熟
我们坐一起听过
当日嫌它的唱法做作
现在听起来竟然很生动
可能是时光让耳朵变得宽容
如今一个人听歌总是会觉得失落
幻听你在我的耳边轻轻诉说
夜色多温柔
你有多爱我
如今一个人听歌总是会觉得难过
爱已不在这里我却还没走脱
列表里的歌
随过往流动
一个人的时候
偷偷看你的微博
你每天做了些什么
我都了然于胸
当时嫌你的蠢话太多
现在回想起画面已泛旧
可能是孤独让情绪变得脆弱
如今一个人听歌总是会觉得失落
幻听你在我的耳边轻轻诉说
夜色多温柔
你有多爱我
如今一个人听歌总是会觉得难过
爱已不在这里我却还没走脱
列表里的歌
随过往流动
如今一个人听歌总是会觉得失落
幻听你在我的耳边轻轻诉说
夜色多温柔
你有多爱我
如今一个人听歌总是会觉得难过
爱已不在这里我却还没走脱
如果你回头
不要放下我
</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/8/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/10/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">雨落诗山山亦奇</div><div class="author-info__description">昨夜星辰昨夜风</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">117</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">12</div></a></div><div class="card-info-data-item is-center">     <a href="/categories"><div class="headline">分类</div><div class="length_num">13</div></a></div></div><div class="card-info-bookmark is-center"><button class="button--animated" id="bookmark-it" type="button" title="加入书签"><i class="fas fa-bookmark"></i><span>加入书签</span></button></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">本站的时光机正在紧急研发中，预计很快便能实现时间旅行了orz~</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a href="/2021/10/10/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1AI%E7%AE%97%E6%B3%95%E5%A4%A7%E8%B5%9BTop2%E6%96%B9%E6%A1%88%E5%88%86%E4%BA%AB/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://www.cdnjson.com/images/2021/10/06/0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" title="电子商务AI算法大赛Top2方案分享" alt="电子商务AI算法大赛Top2方案分享"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2021/10/10/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1AI%E7%AE%97%E6%B3%95%E5%A4%A7%E8%B5%9BTop2%E6%96%B9%E6%A1%88%E5%88%86%E4%BA%AB/" title="电子商务AI算法大赛Top2方案分享">电子商务AI算法大赛Top2方案分享</div><time class="aside-post_meta post-meta__date" title="发表于 2021-10-10 14:25:26">2021-10-10</time></div></a></div><div class="aside-recent-post"><a href="/2021/10/06/%E7%AE%97%E6%B3%95%E4%B8%8B/%E7%AE%97%E6%B3%95%E4%B8%8B/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="算法下" alt="算法下"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2021/10/06/%E7%AE%97%E6%B3%95%E4%B8%8B/%E7%AE%97%E6%B3%95%E4%B8%8B/" title="算法下">算法下</div><time class="aside-post_meta post-meta__date" title="发表于 2021-10-06 15:51:49">2021-10-06</time></div></a></div><div class="aside-recent-post"><a href="/2021/10/06/%E7%AE%97%E6%B3%95(%E4%B8%8A)/%E7%AE%97%E6%B3%95(%E4%B8%8A)/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="算法(上)/算法(上)" alt="算法(上)/算法(上)"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2021/10/06/%E7%AE%97%E6%B3%95(%E4%B8%8A)/%E7%AE%97%E6%B3%95(%E4%B8%8A)/" title="算法(上)/算法(上)">算法(上)/算法(上)</div><time class="aside-post_meta post-meta__date" title="发表于 2021-10-06 14:10:56">2021-10-06</time></div></a></div><div class="aside-recent-post"><a href="/2021/09/30/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1AI%E7%AE%97%E6%B3%95%E5%A4%A7%E8%B5%9Bbaseline/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://www.cdnjson.com/images/2021/10/06/0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" title="电子商务AI算法大赛baseline" alt="电子商务AI算法大赛baseline"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2021/09/30/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1AI%E7%AE%97%E6%B3%95%E5%A4%A7%E8%B5%9Bbaseline/" title="电子商务AI算法大赛baseline">电子商务AI算法大赛baseline</div><time class="aside-post_meta post-meta__date" title="发表于 2021-09-30 12:22:21">2021-09-30</time></div></a></div><div class="aside-recent-post"><a href="/2021/09/02/%E7%94%A8%E4%B8%80%E6%A0%B9%E7%BA%BF%E4%B8%B2%E8%B5%B7%E6%9D%A5-%E4%BB%8E%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E5%88%B0POLY2%E5%88%B0FM%E5%86%8D%E5%88%B0FFM/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://www.cdnjson.com/images/2021/09/03/111.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="推荐模型:从逻辑回归到POLY2到FM再到FFM" alt="推荐模型:从逻辑回归到POLY2到FM再到FFM"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2021/09/02/%E7%94%A8%E4%B8%80%E6%A0%B9%E7%BA%BF%E4%B8%B2%E8%B5%B7%E6%9D%A5-%E4%BB%8E%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E5%88%B0POLY2%E5%88%B0FM%E5%86%8D%E5%88%B0FFM/" title="推荐模型:从逻辑回归到POLY2到FM再到FFM">推荐模型:从逻辑回归到POLY2到FM再到FFM</div><time class="aside-post_meta post-meta__date" title="发表于 2021-09-02 11:03:46">2021-09-02</time></div></a></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/6D%E5%A7%BF%E6%80%81%E4%BC%B0%E8%AE%A1/"><span class="card-category-list-name">6D姿态估计</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CV/"><span class="card-category-list-name">CV</span><span class="card-category-list-count">12</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/GAN/"><span class="card-category-list-name">GAN</span><span class="card-category-list-count">17</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python%E7%A5%9E%E5%99%A8%E5%A4%A7%E7%9B%98%E7%82%B9/"><span class="card-category-list-name">Python神器大盘点</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Tensorflow%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">Tensorflow笔记</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%91%93%E8%AF%AD%E7%B3%BB%E5%88%97%E8%BF%9E%E8%BD%BD/"><span class="card-category-list-name">呓语系列连载</span><span class="card-category-list-count">8</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/"><span class="card-category-list-name">推荐系统</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%AB%9E%E8%B5%9B/"><span class="card-category-list-name">数据竞赛</span><span class="card-category-list-count">3</span></a></li>
            <li class="card-category-list-item more is-center"><a class="card-category-list-link-more" href="/categories">
                <span>查看更多</span><i class="fas fa-angle-right"></i></a></li>           
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/CV/" style="font-size: 16.75px; color: #999b9e">CV</a> <a href="/tags/DL/" style="font-size: 22px; color: #99a9bf">DL</a> <a href="/tags/GAN/" style="font-size: 20.5px; color: #99a5b6">GAN</a> <a href="/tags/LeetCode/" style="font-size: 16px; color: #999">LeetCode</a> <a href="/tags/ML/" style="font-size: 18.25px; color: #999fa7">ML</a> <a href="/tags/Python/" style="font-size: 21.25px; color: #99a7ba">Python</a> <a href="/tags/Tensorflow/" style="font-size: 19.75px; color: #99a3b1">Tensorflow</a> <a href="/tags/%E5%91%93%E8%AF%AD/" style="font-size: 19px; color: #99a1ac">呓语</a> <a href="/tags/%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95/" style="font-size: 17.5px; color: #999da3">推荐算法</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%AB%9E%E8%B5%9B/" style="font-size: 16.75px; color: #999b9e">数据竞赛</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 16px; color: #999">算法</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" style="font-size: 16px; color: #999">计算机基础</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/10/"><span class="card-archive-list-date">十月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">五月 2021</span><span class="card-archive-list-count">15</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">三月 2021</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">117</div></div><div class="webinfo-item"><div class="webinfo-runtime-name">已运行时间 :</div><div class="webinfo-runtime-count" id="webinfo-runtime-count" publish_date="7/2/2020 18:00:00">     </div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 雨落诗山山亦奇</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/third-party/ClickShowText.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js"></script><script>var subtitleEffect = true
if (subtitleEffect) { 
  var typed = new Typed("#subtitle", {
    strings: "期望始终为零，方差交给时间".split(","),
    startDelay: 300,
    typeSpeed: 150,
    loop: true,
    backSpeed: 50
  })
} else {
  document.getElementById("subtitle").innerHTML = '期望始终为零，方差交给时间'
}</script><script src="https://cdn.jsdelivr.net/gh/lete114/CDN/Sum/sakura.js"></script><script src="/js/egao.js"></script><script src="/js/snow.js"></script></body></html>
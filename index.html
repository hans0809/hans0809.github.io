<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>炼丹师养成记 - Python|机器学习|深度学习|生活感悟</title><meta name="description" content="昨夜星辰昨夜风"><meta name="keywords" content="Python|机器学习|深度学习|生活感悟"><meta name="author" content="雨落诗山山亦奇"><meta name="copyright" content="雨落诗山山亦奇"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="http://yoursite.com/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="website"><meta property="og:title" content="炼丹师养成记"><meta property="og:url" content="http://yoursite.com/"><meta property="og:site_name" content="炼丹师养成记"><meta property="og:description" content="昨夜星辰昨夜风"><meta property="og:image" content="http://yoursite.com/img/avatar.png"><meta property="article:published_time" content="2020-11-18T14:02:58.518Z"><meta property="article:modified_time" content="2020-11-18T14:02:58.518Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"我爱学习,机器学习,深度学习,学习使我快乐","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2020-11-18 22:02:58'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="/css/mouse.css">
<link rel="stylesheet" href="/css/gundongtiao.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macblack.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"> <link rel="stylesheet" href="/css/waigua.css"> <link rel="stylesheet" href="/css/beijing.css"><div class="aplayer" data-id="476185587" data-server="netease" data-type="playlist" data-fixed="true" data-listFolded="false" data-order="list" data-preload="auto"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lete114/CDN/music/APlayer/APlayer.min.css"><script src="https://cdn.jsdelivr.net/gh/lete114/CDN/music/APlayer/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script><meta name="generator" content="Hexo 4.2.1"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">49</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">7</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><header class="full_page" id="page-header" style="background-image: url(/img/tag1.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">炼丹师养成记</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">炼丹师养成记</h1><div id="site_subtitle"><span id="subtitle"></span></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/18/CycleGAN/" title="CycleGAN">     <img class="post_bg" data-src="https://s3.ax1x.com/2020/11/18/Dny5lt.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CycleGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/18/CycleGAN/" title="CycleGAN">CycleGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-11-18 20:15:03"><i class="far fa-calendar-alt"></i>2020-11-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">导入相关包123456789101112import tensorflow as tfimport tensorflow_addons as tfafrom tensorflow.keras.layers import Dropout, Concatenate,BatchNormalization,LeakyReLU,UpSampling2D, Conv2Dfrom tensorflow.keras.optimizers import Adamimport matplotlib.pyplot as pltimport sysimport osfrom skimage.transform import  resizeimport imageiofrom glob import globimport numpy as nptf.keras.backend.set_floatx('float64')

读取数据12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/13/%E5%AE%89%E8%A3%85cudnn/" title="安装CUDA">     <img class="post_bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安装CUDA"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/13/%E5%AE%89%E8%A3%85cudnn/" title="安装CUDA">安装CUDA</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-11-13 20:55:27"><i class="far fa-calendar-alt"></i>2020-11-13</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">环境配置</a></span></div><div class="content">在安装了英伟达驱动的基础上，安装CUDA：

下载CUDA安装包
1wget



</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/29/SRGAN/" title="SRGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/29/BYPnKJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SRGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/29/SRGAN/" title="SRGAN">SRGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-29 22:05:10"><i class="far fa-calendar-alt"></i>2020-10-29</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">通过采样等方式获取高清图片的低分辨率版本，两者形成一一映射的关系，作为准备好的数据集。
不同于之前的GAN的输入为noise，SRGAN 的输入为低分辨率图片，希望通过对抗的方式学习如何生成低分辨率图片的超清版本。
主要改动的地方除了生成器和判别器的架构外，就是损失函数了：判别器的损失函数无需改动，而生成器的损失函数在原来的基础上，需要再增加两项，一个是真实图片与生成图片的均方误差，另一个是真实图片与生成图片经过vgg19提取得到的特征之间的均方误差（论文中把这两个合起来叫做内容损失，而之前生成器的损失叫做对抗损失，内容损失+对抗损失=感知损失）。

代码导入相关函数1234567import tensorflow as tfimport matplotlib.pyplot as pltimport numpy as npfrom tensorflow.keras import layersimport scipy#需要执行 pip install scipy==1.2.1 来给scipy降级from glob import globimport datetime

准备数据12345 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/20/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E3%80%91%E5%9F%BA%E4%BA%8E%E6%9D%A1%E4%BB%B6%E7%94%9F%E6%88%90%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%9A%84%E7%89%99%E5%90%88%E9%9D%A2%E4%B8%AA%E6%80%A7%E5%8C%96%E8%AE%BE%E8%AE%A1%E6%8A%80%E6%9C%AF/" title="【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/29/BYCPfO.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/20/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E3%80%91%E5%9F%BA%E4%BA%8E%E6%9D%A1%E4%BB%B6%E7%94%9F%E6%88%90%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%9A%84%E7%89%99%E5%90%88%E9%9D%A2%E4%B8%AA%E6%80%A7%E5%8C%96%E8%AE%BE%E8%AE%A1%E6%8A%80%E6%9C%AF/" title="【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术">【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-20 14:09:20"><i class="far fa-calendar-alt"></i>2020-10-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">论文阅读</a></span></div><div class="content">摘要This article proposes an intelligent network model for designing tooth crown surface based on conditional generative adversarial networks. Then, the data set for training the network model is constructed via generating depth maps of 3D tooth models scanned by the intraoral. Through adversarial training, the network model is able to generate tooth occlusal surface under the constraint of the space occlusal relationship, the perceptual loss, and occlusal groove filter loss. Finally, we carry out ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/19/infoGAN/" title="infoGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/16/0qFbOx.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="infoGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/19/infoGAN/" title="infoGAN">infoGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-19 20:46:08"><i class="far fa-calendar-alt"></i>2020-10-19</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">导入相关函数12345import tensorflow as tfimport matplotlib.pyplot as pltimport numpy as npfrom tensorflow.keras import layersfrom tensorflow.keras.utils import to_categorical


准备数据1(train_images,train_labels),(_,_)=tf.keras.datasets.mnist.load_data()


1train_images.shape




(60000, 28, 28)1train_images.dtype




dtype(&apos;uint8&apos;)1train_images=train_images.reshape(train_images.shape[0],28,28,1).astype('float32')


1train_images.shape




(60000, 28, 28, 1)1train_images.dtype




dtype(&apos;fl ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/16/ACGAN/" title="ACGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/16/0qFbOx.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ACGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/16/ACGAN/" title="ACGAN">ACGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-16 16:05:10"><i class="far fa-calendar-alt"></i>2020-10-16</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">网络结构ACGAN 可以看作是CGAN和SGAN的融合：

模仿CGAN，将类别标签class也输入生成器
模仿SGAN，判别器不仅仅输出真假，还充当分类器


搭建模型由于ACGAN可以看作是CGAN和SGAN的融合，因此在代码实现上也是综合了两者的代码，主要修改部分为损失函数和两个网络结构，具体见代码注释
ACGAN的损失部分如下：
判别损失：

分类损失：

判别器的损失为$L_C+L_S$，意思是让判别器既能判别图片的真伪，又有不错的分类能力；
生成器的损失为$L_C-L_S$，意思是让判别器不能判别图片的真伪，但还有不错的分类能力。
导入相关函数12345import tensorflow as tfimport matplotlib.pyplot as pltimport numpy as npfrom tensorflow.keras import layersfrom tensorflow.keras.utils import to_categorical

准备数据1(train_images,train_labels),(_,_)=tf.keras.datasets ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/15/%E5%AF%B9%E5%89%8D%E9%9D%A2%E4%B8%89%E7%AF%87%E6%96%87%E7%AB%A0%E7%9A%84%E8%AF%B4%E6%98%8E/" title="对前面三篇文章的总结">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/16/0qk23d.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="对前面三篇文章的总结"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/15/%E5%AF%B9%E5%89%8D%E9%9D%A2%E4%B8%89%E7%AF%87%E6%96%87%E7%AB%A0%E7%9A%84%E8%AF%B4%E6%98%8E/" title="对前面三篇文章的总结">对前面三篇文章的总结</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-15 22:00:20"><i class="far fa-calendar-alt"></i>2020-10-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Tensorflow%E7%AC%94%E8%AE%B0/">Tensorflow笔记</a></span></div><div class="content">序章起初，我觉得使用Keras的那些API，比如train_on_batch，compile等等，极大的减少了代码量，对刚刚入门的小白来说比较友好。
在开始接触GAN之后，发现一些关于GAN的书籍，比如GANs in action，一些关于GAN的博客，如machinelearningmastery，CSDN以及一些能搜到的视频教程，很多都是用的Keras或者tf.keras
于是我也准备学习用tf.keras来实现各种GAN。
后来，经过一小段时间的学习，虽然也跟着别人的代码写出了几个能跑通的GAN，但总觉得keras的代码怪怪的。
高度封装的API，虽然容易使得小白入门，但同时也使得使用者对其内部的机制还是不怎么了解。比如之前困扰我很久的一个问题，就是关于模型的trainable参数的设置问题，明明已经设置为discriminator.trainable=False了，在后面的train_on_batch时，discriminator还能被训练。最后找到了一个不太确定的答案，详细见这篇文章：
https://fx0809.gitee.io/2020/10/12/Keras%E4%B ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/15/DCGAN-V2-0/" title="DCGAN_V2.0">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/07/0dSxjx.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DCGAN_V2.0"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/15/DCGAN-V2-0/" title="DCGAN_V2.0">DCGAN_V2.0</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-15 16:03:22"><i class="far fa-calendar-alt"></i>2020-10-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">导入相关函数1234import tensorflow as tfimport matplotlib.pyplot as pltimport numpy as npfrom tensorflow.keras import layers

准备数据1(train_images,train_labels),(_,_)=tf.keras.datasets.mnist.load_data()


1train_images.shape


1train_images.dtype


1train_images=train_images.reshape(train_images.shape[0],28,28,1).astype('float32')


1train_images.shape


1train_images.dtype


1train_images=(train_images-127.5)/127.1#归一化


12BATCH_SIZE=256BUFFER_SIZE=60000


1datasets=tf.data.Dataset.from_tensor_slices(tr ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/10/15/warning-tensorflow-Grandients-do-not-exist/" title="【警告原因不明，怀疑是梯度消失】warning:tensorflow:Grandients_do_not_exist">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/07/19/URRLqI.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【警告原因不明，怀疑是梯度消失】warning:tensorflow:Grandients_do_not_exist"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/15/warning-tensorflow-Grandients-do-not-exist/" title="【警告原因不明，怀疑是梯度消失】warning:tensorflow:Grandients_do_not_exist">【警告原因不明，怀疑是梯度消失】warning:tensorflow:Grandients_do_not_exist</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-15 15:29:51"><i class="far fa-calendar-alt"></i>2020-10-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Tensorflow%E7%AC%94%E8%AE%B0/">Tensorflow笔记</a></span></div><div class="content">更新！！！
好像并不是Dropout的原因，在训练SGAN时也出现了同样的警告，即使已经设置了Dropout层的traing=True，怀疑是梯度消失（有文章说是这个 https://www.jiqizhixin.com/articles/2018-11-27-24 ）或爆炸

在本文中，可能设置training=Trur恰好避免了梯度消失或爆炸，只是凑巧而已（猜测）
具体原因后续再来分析，先这样了。
问题提出基于DCGAN（https://fx0809.gitee.io/2020/10/07/DCGAN/）的代码，想要将生成器和判别器的实现方式改为继承自`tf.keras.Model`类的方式，修改部分的代码如下：
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869class Generator_model(tf.keras.Model):    def __init__(sel ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/10/15/SGAN/" title="【训练结果很糟糕】SGAN">     <img class="post_bg" data-src="https://s1.ax1x.com/2020/10/15/07Q3Eq.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【训练结果很糟糕】SGAN"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/10/15/SGAN/" title="【训练结果很糟糕】SGAN">【训练结果很糟糕】SGAN</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2020-10-15 10:05:50"><i class="far fa-calendar-alt"></i>2020-10-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/GAN/">GAN</a></span></div><div class="content">2020年10月16号更新：
应该是由于判别器本身的网络结构导致的(应证了猜想1)。
在训练ACGAN时，梯度也出现了问题（warning），我将判别器由卷积层换成了全连接层，再次运行就能正常训练了，详见这篇文章：
什么是SGAN在原始GAN架构的基础上，将判别器的二分类（真实样本or生成样本）改为多分类(共N+1，N classes+fake)，便得到了SGAN( Semi-Supervised  GAN) 。
此时，分类器（同时也是判别器）的表现更好，并且生成器生成的图片的质量也更高。

如何实现SGAN生成器模型无需改动，需要改动的是判别模型以及后续的训练过程
导入相关函数12345import tensorflow as tfimport matplotlib.pyplot as pltimport numpy as npfrom tensorflow.keras import layersfrom tensorflow.keras.utils import to_categorical

准备数据1(train_images,train_labels),(_,_)=tf.ke ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">雨落诗山山亦奇</div><div class="author-info__description">昨夜星辰昨夜风</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">49</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">7</div></a></div><div class="card-info-data-item is-center">     <a href="/categories"><div class="headline">分类</div><div class="length_num">7</div></a></div></div><div class="card-info-bookmark is-center"><button class="button--animated" id="bookmark-it" type="button" title="加入书签"><i class="fas fa-bookmark"></i><span>加入书签</span></button></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">本站的时光机正在紧急研发中，预计很快便能实现时间旅行了orz~</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a href="/2020/11/18/CycleGAN/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s3.ax1x.com/2020/11/18/Dny5lt.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="CycleGAN" alt="CycleGAN"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2020/11/18/CycleGAN/" title="CycleGAN">CycleGAN</div><time class="aside-post_meta post-meta__date" title="发表于 2020-11-18 20:15:03">2020-11-18</time></div></a></div><div class="aside-recent-post"><a href="/2020/11/13/%E5%AE%89%E8%A3%85cudnn/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="安装CUDA" alt="安装CUDA"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2020/11/13/%E5%AE%89%E8%A3%85cudnn/" title="安装CUDA">安装CUDA</div><time class="aside-post_meta post-meta__date" title="发表于 2020-11-13 20:55:27">2020-11-13</time></div></a></div><div class="aside-recent-post"><a href="/2020/10/29/SRGAN/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s1.ax1x.com/2020/10/29/BYPnKJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="SRGAN" alt="SRGAN"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2020/10/29/SRGAN/" title="SRGAN">SRGAN</div><time class="aside-post_meta post-meta__date" title="发表于 2020-10-29 22:05:10">2020-10-29</time></div></a></div><div class="aside-recent-post"><a href="/2020/10/20/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E3%80%91%E5%9F%BA%E4%BA%8E%E6%9D%A1%E4%BB%B6%E7%94%9F%E6%88%90%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%9A%84%E7%89%99%E5%90%88%E9%9D%A2%E4%B8%AA%E6%80%A7%E5%8C%96%E8%AE%BE%E8%AE%A1%E6%8A%80%E6%9C%AF/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s1.ax1x.com/2020/10/29/BYCPfO.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术" alt="【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2020/10/20/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E3%80%91%E5%9F%BA%E4%BA%8E%E6%9D%A1%E4%BB%B6%E7%94%9F%E6%88%90%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%9A%84%E7%89%99%E5%90%88%E9%9D%A2%E4%B8%AA%E6%80%A7%E5%8C%96%E8%AE%BE%E8%AE%A1%E6%8A%80%E6%9C%AF/" title="【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术">【论文阅读】基于条件生成对抗网络的牙合面个性化设计技术</div><time class="aside-post_meta post-meta__date" title="发表于 2020-10-20 14:09:20">2020-10-20</time></div></a></div><div class="aside-recent-post"><a href="/2020/10/19/infoGAN/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s1.ax1x.com/2020/10/16/0qFbOx.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="infoGAN" alt="infoGAN"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2020/10/19/infoGAN/" title="infoGAN">infoGAN</div><time class="aside-post_meta post-meta__date" title="发表于 2020-10-19 20:46:08">2020-10-19</time></div></a></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/GAN/"><span class="card-category-list-name">GAN</span><span class="card-category-list-count">16</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Tensorflow%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">Tensorflow笔记</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%91%93%E8%AF%AD%E7%B3%BB%E5%88%97%E8%BF%9E%E8%BD%BD/"><span class="card-category-list-name">呓语系列连载</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">深度学习笔记</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="card-category-list-name">环境配置</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/"><span class="card-category-list-name">论文阅读</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8Python%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/"><span class="card-category-list-name">零基础入门Python系列教程</span><span class="card-category-list-count">13</span></a></li>
                       
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/DL/" style="font-size: 18.4px; color: #999fa8">DL</a> <a href="/tags/GAN/" style="font-size: 22px; color: #99a9bf">GAN</a> <a href="/tags/Python/" style="font-size: 20.8px; color: #99a6b7">Python</a> <a href="/tags/Tensorflow/" style="font-size: 19.6px; color: #99a3b0">Tensorflow</a> <a href="/tags/%E5%91%93%E8%AF%AD/" style="font-size: 17.2px; color: #999ca1">呓语</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" style="font-size: 16px; color: #999">环境配置</a> <a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 16px; color: #999">论文</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/11/"><span class="card-archive-list-date">十一月 2020</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/10/"><span class="card-archive-list-date">十月 2020</span><span class="card-archive-list-count">20</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/08/"><span class="card-archive-list-date">八月 2020</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/07/"><span class="card-archive-list-date">七月 2020</span><span class="card-archive-list-count">19</span></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">49</div></div><div class="webinfo-item"><div class="webinfo-runtime-name">已运行时间 :</div><div class="webinfo-runtime-count" id="webinfo-runtime-count" publish_date="7/2/2020 18:00:00">     </div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><!--.copyright!= `&copy;${nowYear} By ${config.author}`--><div class="copyright">&copy;2020 <i id="heartbeat" style="color:#FF6A6A" class="fa fa-heartbeat"></i> 雨落诗山山亦奇</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/third-party/ClickShowText.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js"></script><script>var subtitleEffect = true
if (subtitleEffect) { 
  var typed = new Typed("#subtitle", {
    strings: "晚来天欲雪，能饮一杯无？,欲买桂花同载酒，终不似，少年游,醉后不知天在水，满船清梦压星河".split(","),
    startDelay: 300,
    typeSpeed: 150,
    loop: true,
    backSpeed: 50
  })
} else {
  document.getElementById("subtitle").innerHTML = '晚来天欲雪，能饮一杯无？'
}</script><script src="https://cdn.jsdelivr.net/gh/lete114/CDN/Sum/sakura.js"></script><script src="/js/egao.js"></script><script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script><script src="/js/snow.js"></script></body></html>